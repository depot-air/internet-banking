package com.dwidasa.interlink.medium.queue;

import com.dwidasa.interlink.Listener;

/**
 * @author prayugo
 */
public class DQSimulator extends Thread {

	private boolean status = false;
	
	private Listener listener;
	private String data;
	
	public DQSimulator( Listener listener ) {
	
		this.listener = listener;
	}
	
	public void startup() {
		
		this.status = true;
		start();
	}
	
	public void shutdown() {
		
		this.status = false;
		interrupt();
	}
	
	@Override
	public void run() {
		
		while( status ) {
			
			try {
				sleep( 5 * 1000 );
			}
			catch( Exception e ) {
				
			}
		}
	}
	
	public boolean simulate( String m ) {
	
		this.data = m;
		
		process();
		
		return true;
	}
	
	private void process() {
		
		String tt = data.substring( 0, 2 );
		
		if( "01".equals( tt ) ) {							// -- portfolio saving & checking
			data = data.substring( 0, 46 ) + "0010 ";
			listener.onMessage( data + "04702000121NAMA REKENING 065000 00400838 1TABUNGAN HARIAN               IDR004000000000000000+000000000000000+000000000100000+000000000000000+000000000082516-04702000511NAMA REKENING 073000 00400993 1TABUNGAN HARIAN               IDR004000000000000000+000000000000000+000000000100000+000000000000000+000000073806020+04702001111NAMA REKENING 024000 00400152 1TABUNGAN HARIAN               IDR004000000000000000+000000000000000+000000000100000+000000000000000+000000001294025+04702001191NAMA REKENING 034000 00400287 1TABUNGAN HARIAN               IDR004000000000000000+000000000000000+000000000100000+000000000000000+000000000078552-04702001381NAMA REKENING 124000 00401923 1TABUNGAN HARIAN               IDR004000000000000000+000000000000000+000000000100000+000000000000000+000000000040742+04702001561NAMA REKENING 121000 00401892 1TABUNGAN HARIAN               IDR004000000000000000+000000000000000+000000000100000+000000000000000+000000000104321+04702002191NAMA REKENING 085000 00401250 1TABUNGAN HARIAN               IDR004000000000000000+000000000000000+000000000100000+000000000000000+000000000326344+04702002551NAMA REKENING 077000 00401090 1TABUNGAN HARIAN               IDR004000000000000000+000000000000000+000000000100000+000000000000000+000000000504360+04702002611NAMA REKENING 129000 00402052 1TABUNGAN HARIAN               IDR004000000000000000+000000000000000+000000000100000+000000000000000+000000000088196+04702004401NAMA REKENING 083000 00401178 1TABUNGAN HARIAN               IDR004000000000000000+000000000000000+000000000100000+000000000000000+000000000097482+" );
		}
		else if( "02".equals( tt ) ) {						// -- portfolio time deposit
			data = data.substring( 0, 46 ) + "0001 ";
			listener.onMessage( data + "0432948290IDR000000154000000006012201201282012072716404475551" );
		}
		else if( "03".equals( tt ) ) {						// -- portfolio loan
			data = data.substring( 0, 46 ) + "0001 ";
			listener.onMessage( data + "LN09322114IDR000025000000055000002400000112000000002350000020100128201401270000000150000000000450002012042920120429" );
		}
	}
	
}
